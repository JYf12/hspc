{"remainingRequest":"D:\\其他\\刘老师\\项目\\华胜投标招标\\bidding-agent-be\\front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\其他\\刘老师\\项目\\华胜投标招标\\bidding-agent-be\\front\\src\\views\\form\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\其他\\刘老师\\项目\\华胜投标招标\\bidding-agent-be\\front\\src\\views\\form\\index.vue","mtime":1681890160665},{"path":"D:\\其他\\刘老师\\项目\\华胜投标招标\\bidding-agent-be\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1681715802937},{"path":"D:\\其他\\刘老师\\项目\\华胜投标招标\\bidding-agent-be\\front\\node_modules\\babel-loader\\lib\\index.js","mtime":1681715802987},{"path":"D:\\其他\\刘老师\\项目\\华胜投标招标\\bidding-agent-be\\front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1681715802937},{"path":"D:\\其他\\刘老师\\项目\\华胜投标招标\\bidding-agent-be\\front\\node_modules\\vue-loader\\lib\\index.js","mtime":1681715801225}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGFkZFByb2plY3QsIGFkZFByb2plY3RGaWxlIH0gZnJvbSAnQC9hcGkvdGFibGUnCgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZvcm06IHsKICAgICAgICBwcm9qZWN0TmFtZTogJycsCiAgICAgICAgYWRkaXRpb246ICcnLAogICAgICAgIC8vIOWKqOaAgeihqOWNleaVsOaNrgogICAgICAgIHRhYmxlRGF0YTogW3sKICAgICAgICAgIHBhY2thZ2VOYW1lOiAnJywKICAgICAgICAgIHByaWNlOiAnJywKICAgICAgICAgIGZpbGVQYXRoOiAnJywKICAgICAgICAgIGZpbGVOYW1lOiAnJywKICAgICAgICAgIHN0YXJ0VGltZTogJycsCiAgICAgICAgICBlbmRUaW1lOiAnJwogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIGZpbGVMaXN0OiBbe31dCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBvblN1Ym1pdCgpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmZpbGVMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGZpbGVkYXRhID0gbmV3IEZvcm1EYXRhKCkKICAgICAgICBmaWxlZGF0YS5hcHBlbmQoJ2ZpbGUnLCB0aGlzLmZpbGVMaXN0W2ldLnJhdykKICAgICAgICBhd2FpdCBhZGRQcm9qZWN0RmlsZShmaWxlZGF0YSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2UubWVzc2FnZSA9PT0gJ3N1Y2Nlc3MnKSB7CiAgICAgICAgICAgIHRoaXMuZm9ybS50YWJsZURhdGFbaV0uZmlsZVBhdGggPSByZXNwb25zZS5kYXRhLmZpbGVQYXRoCiAgICAgICAgICAgIHRoaXMuZm9ybS50YWJsZURhdGFbaV0uZmlsZU5hbWUgPSByZXNwb25zZS5kYXRhLmZpbGVOYW1lCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpID0gaSAtIDEKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICB9CiAgICAgIGFkZFByb2plY3QodGhpcy5mb3JtKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSkKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+WIm+W7uuaIkOWKn++8gScpCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy90YWJsZScpCiAgICAgIH0pCiAgICB9LAogICAgb25DYW5jZWwoKSB7CiAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgIG1lc3NhZ2U6ICdjYW5jZWwhJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkKICAgIH0sCiAgICBhZGRMaXN0KCkgewogICAgICB0aGlzLmZvcm0udGFibGVEYXRhLnB1c2goewogICAgICAgIHBhY2thZ2VOYW1lOiAnJywKICAgICAgICBwcmljZTogJycsCiAgICAgICAgZmlsZVBhdGg6ICcnCiAgICAgIH0pCiAgICAgIHRoaXMuZmlsZUxpc3QucHVzaCh7fSkKICAgIH0sCiAgICAvLyDmlrDlop7kuIDooYwKICAgIGFkZFBhcmFtc1NldHRpbmcoKSB7CiAgICAgIHRoaXMuYWRkTGlzdCgpCiAgICB9LAoKICAgIC8vIOWIoOmZpOW9k+WJjeihjAogICAgZGVsZXRlUm93KGluZGV4KSB7CiAgICAgIHRoaXMuZm9ybS50YWJsZURhdGEuc3BsaWNlKGluZGV4LCAxKQogICAgICB0aGlzLmZpbGVMaXN0LnNwbGljZShpbmRleCwgMSkKICAgIH0sCiAgICBoYW5kbGVDaGFuZ2UoZmlsZSwgZmlsZWxpc3QsIGluZGV4KSB7CiAgICAgIGlmIChmaWxlKSB7CiAgICAgICAgdGhpcy5maWxlTGlzdFtpbmRleF0gPSBmaWxlbGlzdFtmaWxlbGlzdC5sZW5ndGggLSAxXQogICAgICB9CiAgICB9LAoKICAgIGhhbmRsZVJlbW92ZShmaWxlLCBmaWxlbGlzdCwgaW5kZXgpIHsKICAgICAgY29uc29sZS5sb2coZmlsZSwgZmlsZWxpc3QpCiAgICAgIHRoaXMuZmlsZUxpc3RbaW5kZXhdID0ge30KICAgIH0sCiAgICBoYW5kbGVQcmV2aWV3KGZpbGUpIHsKICAgICAgY29uc29sZS5sb2coZmlsZSkKICAgIH0sCiAgICBoYW5kbGVFeGNlZWQoZmlsZXMsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZyhg5b2T5YmN6ZmQ5Yi26YCJ5oupIDEg5Liq5paH5Lu277yM5pys5qyh6YCJ5oup5LqGICR7ZmlsZXMubGVuZ3RofSDkuKrmlofku7bvvIzlhbHpgInmi6nkuoYgJHtmaWxlcy5sZW5ndGggKyBmaWxlTGlzdC5sZW5ndGh9IOS4quaWh+S7tmApCiAgICB9LAogICAgYmVmb3JlUmVtb3ZlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHJldHVybiB0aGlzLiRjb25maXJtKGDnoa7lrprnp7vpmaQgJHtmaWxlLm5hbWV977yfYCkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqHA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/form","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form ref=\"form\" :model=\"form\" label-width=\"120px\">\n      <el-form-item label=\"项目名称\">\n        <el-input v-model=\"form.projectName\"/>\n      </el-form-item>\n      <el-form-item label=\"备注\">\n        <el-input v-model=\"form.addition\" type=\"textarea\"/>\n      </el-form-item>\n\n      <el-form-item>\n        <el-button type=\"primary\" size=\"small\" @click=\"addParamsSetting\">新增包件</el-button>\n      </el-form-item>\n      <el-form-item label=\"包件信息\">\n        <el-table\n          :data=\"form.tableData\"\n          style=\"width: 100%\"\n          class=\"list-table\"\n          size=\"mini\"\n          border>\n          <el-table-column prop=\"index\" label=\"序号\" width=\"110\">\n            <template slot-scope=\"scope\">\n              <el-form-item>\n                {{ scope.$index + 1 }}\n              </el-form-item>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"packageName\" label=\"包件名称\" width=\"150\">\n            <template slot-scope=\"scope\">\n              <el-form-item\n                label=\"\"\n                :prop=\"'form.tableData.' + scope.$index + '.packageName'\"\n                :rules=\"[{ required: true, message: '包件名称不可为空', trigger: 'change' }]\">\n                <el-input v-model=\"scope.row.packageName\" placeholder=\"请输入包件名称\"></el-input>\n              </el-form-item>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"price\" label=\"招标文件费\" width=\"150\">\n            <template slot-scope=\"scope\">\n              <el-form-item\n                label=\"\"\n                :prop=\"'form.tableData.' + scope.$index + '.price'\"\n                :rules=\"[{ required: true, message: '招标文件费不可为空', trigger: 'change' }, { type: 'number', message: '招标文件费必须为数字值'}]\"\n              >\n                <el-input v-model=\"scope.row.price\" placeholder=\"请输入招标文件费\" @keyup=\"value=value.replace(/[^\\d]/g,'')\" @blur=\"value=value.replace(/[^\\d]/g,'')\">\n                  <template slot=\"append\">元</template>\n                </el-input>\n              </el-form-item>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"startTime\" label=\"开始时间\">\n            <template slot-scope=\"scope\">\n              <el-form-item\n                label=\"\"\n                :prop=\"'form.tableData.' + scope.$index + '.startTime'\"\n                :rules=\"[{ required: true, message: '开始时间不可为空', trigger: 'change' }]\">\n                <el-date-picker\n                  v-model=\"scope.row.startTime\"\n                  type=\"datetime\"\n                  placeholder=\"选择开始时间\"\n                  value-format=\"yyyy-MM-dd HH:mm:ss\">\n                </el-date-picker>\n              </el-form-item>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"endTime\" label=\"结束时间\">\n            <template slot-scope=\"scope\">\n              <el-form-item\n                label=\"\"\n                :prop=\"'form.tableData.' + scope.$index + '.endTime'\"\n                :rules=\"[{ required: true, message: '结束时间不可为空', trigger: 'change' }]\">\n                <el-date-picker\n                  v-model=\"scope.row.endTime\"\n                  type=\"datetime\"\n                  placeholder=\"选择结束时间\"\n                  value-format=\"yyyy-MM-dd HH:mm:ss\">\n                </el-date-picker>\n              </el-form-item>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"filePath\" label=\"招标文件\" width=\"200\">\n            <template slot-scope=\"scope\">\n              <el-form-item\n                label=\"\"\n                :prop=\"'form.tableData.' + scope.$index + '.fileList'\"\n                :rules=\"[{ required: true, message: '招标文件不可为空', trigger: 'change' }]\"\n              >\n                <el-upload\n                  action=\"http://localhost:8089\"\n                  class=\"upload-demo\"\n                  ref=\"upload\"\n                  :on-change=\"(file, filelist) => {handleChange(file, filelist, scope.$index)}\"\n                  :on-preview=\"handlePreview\"\n                  :on-remove=\"(file, filelist) => {handleRemove(file, filelist, scope.$index)}\"\n                  :limit=\"1\"\n                  :auto-upload=\"false\">\n                  选取文件\n                </el-upload>\n              </el-form-item>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"操作\" width=\"50\">\n            <template slot-scope=\"scope\">\n              <el-button @click.native.prevent=\"deleteRow(scope.$index)\" type=\"text\" size=\"small\">删除</el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </el-form-item>\n      <el-form-item align=\"center\">\n        <el-button type=\"primary\" @click=\"onSubmit\">创建</el-button>\n        <el-button @click=\"onCancel\">取消</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { addProject, addProjectFile } from '@/api/table'\n\nexport default {\n  data() {\n    return {\n      form: {\n        projectName: '',\n        addition: '',\n        // 动态表单数据\n        tableData: [{\n          packageName: '',\n          price: '',\n          filePath: '',\n          fileName: '',\n          startTime: '',\n          endTime: ''\n        }]\n      },\n      fileList: [{}]\n    }\n  },\n  methods: {\n    async onSubmit() {\n      for (var i = 0; i < this.fileList.length; i++) {\n        var filedata = new FormData()\n        filedata.append('file', this.fileList[i].raw)\n        await addProjectFile(filedata).then(response => {\n          if (response.message === 'success') {\n            this.form.tableData[i].filePath = response.data.filePath\n            this.form.tableData[i].fileName = response.data.fileName\n          } else {\n            i = i - 1\n          }\n        })\n      }\n      addProject(this.form).then(response => {\n        console.log(response)\n        this.$message.success('创建成功！')\n        this.$router.push('/table')\n      })\n    },\n    onCancel() {\n      this.$message({\n        message: 'cancel!',\n        type: 'warning'\n      })\n    },\n    addList() {\n      this.form.tableData.push({\n        packageName: '',\n        price: '',\n        filePath: ''\n      })\n      this.fileList.push({})\n    },\n    // 新增一行\n    addParamsSetting() {\n      this.addList()\n    },\n\n    // 删除当前行\n    deleteRow(index) {\n      this.form.tableData.splice(index, 1)\n      this.fileList.splice(index, 1)\n    },\n    handleChange(file, filelist, index) {\n      if (file) {\n        this.fileList[index] = filelist[filelist.length - 1]\n      }\n    },\n\n    handleRemove(file, filelist, index) {\n      console.log(file, filelist)\n      this.fileList[index] = {}\n    },\n    handlePreview(file) {\n      console.log(file)\n    },\n    handleExceed(files, fileList) {\n      this.$message.warning(`当前限制选择 1 个文件，本次选择了 ${files.length} 个文件，共选择了 ${files.length + fileList.length} 个文件`)\n    },\n    beforeRemove(file, fileList) {\n      return this.$confirm(`确定移除 ${file.name}？`)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.line {\n  text-align: center;\n}\n</style>\n\n"]}]}