{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-7dc3911c\"],{\"5cf7\":function(e,t,a){\"use strict\";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"app-container\"},[a(\"el-form\",{ref:\"form\",attrs:{model:e.projectInfo,\"label-width\":\"120px\"}},[a(\"el-form-item\",[\"readonly\"===e.readStatus?a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.handleUpdataForm}},[e._v(\"修改\")]):e._e(),\"\"===e.readStatus?a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.handleSubmitUpdata}},[e._v(\"确定\")]):e._e(),\"\"===e.readStatus?a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.cancelModification}},[e._v(\"取消\")]):e._e(),a(\"el-button\",{attrs:{type:\"warning\"},on:{click:e.onclickStopProject}},[e._v(\"停止招标\")]),a(\"el-button\",{attrs:{type:\"danger\"},on:{click:e.onclickDeleteProject}},[e._v(\"删除\")])],1),a(\"el-form-item\",{attrs:{label:\"项目编号\"}},[a(\"el-input\",{attrs:{readonly:\"readonly\"===e.readStatus},model:{value:e.projectInfo.projectId,callback:function(t){e.$set(e.projectInfo,\"projectId\",t)},expression:\"projectInfo.projectId\"}})],1),a(\"el-form-item\",{attrs:{label:\"项目名称\"}},[a(\"el-input\",{attrs:{readonly:\"readonly\"===e.readStatus},model:{value:e.projectInfo.projectName,callback:function(t){e.$set(e.projectInfo,\"projectName\",t)},expression:\"projectInfo.projectName\"}})],1),a(\"el-form-item\",{attrs:{label:\"备注\"}},[a(\"el-input\",{attrs:{readonly:\"readonly\"===e.readStatus,type:\"textarea\"},model:{value:e.projectInfo.addition,callback:function(t){e.$set(e.projectInfo,\"addition\",t)},expression:\"projectInfo.addition\"}})],1),a(\"el-form-item\",[\"\"===e.readStatus?a(\"el-button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:e.addParamsSetting}},[e._v(\"新增包件\")]):e._e()],1),a(\"el-form-item\",{attrs:{label:\"包件信息\"}},[a(\"el-table\",{staticClass:\"list-table\",staticStyle:{width:\"100%\"},attrs:{data:e.updateData.packageList,size:\"mini\",border:\"\"}},[a(\"el-table-column\",{attrs:{prop:\"index\",label:\"序号\",width:\"50\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-form-item\",[e._v(\" \"+e._s(t.$index+1)+\" \")])]}}])}),a(\"el-table-column\",{attrs:{prop:\"packageName\",label:\"包件名称\",width:\"150\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-form-item\",{attrs:{label:\"\",prop:\"form.tableData.\"+t.$index+\".packageName\",rules:[{required:!0,message:\"包件名称不可为空\",trigger:\"change\"}]}},[a(\"el-input\",{attrs:{readonly:\"readonly\"===e.readStatus,placeholder:\"请输入包件名称\"},model:{value:t.row.packageName,callback:function(a){e.$set(t.row,\"packageName\",a)},expression:\"scope.row.packageName\"}})],1)]}}])}),a(\"el-table-column\",{attrs:{prop:\"price\",label:\"招标文件费\",width:\"150\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-form-item\",{attrs:{label:\"\",prop:\"form.tableData.\"+t.$index+\".price\",rules:[{required:!0,message:\"招标文件费不可为空\",trigger:\"change\"}]}},[a(\"el-input\",{attrs:{readonly:\"readonly\"===e.readStatus,placeholder:\"请输入招标文件费\"},on:{keyup:function(t){e.value=e.value.replace(/[^\\d]/g,\"\")},blur:function(t){e.value=e.value.replace(/[^\\d]/g,\"\")}},model:{value:t.row.price,callback:function(a){e.$set(t.row,\"price\",a)},expression:\"scope.row.price\"}},[a(\"template\",{slot:\"append\"},[e._v(\"元\")])],2)],1)]}}])}),a(\"el-table-column\",{attrs:{prop:\"startTime\",label:\"开始时间\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-form-item\",{attrs:{label:\"\",prop:\"form.tableData.\"+t.$index+\".startTime\",rules:[{required:!0,message:\"开始时间不可为空\",trigger:\"change\"}]}},[a(\"el-date-picker\",{attrs:{readonly:\"readonly\"===e.readStatus,type:\"datetime\",placeholder:\"选择开始时间\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\"},model:{value:t.row.startTime,callback:function(a){e.$set(t.row,\"startTime\",a)},expression:\"scope.row.startTime\"}})],1)]}}])}),a(\"el-table-column\",{attrs:{prop:\"endTime\",label:\"结束时间\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-form-item\",{attrs:{label:\"\",prop:\"form.tableData.\"+t.$index+\".endTime\",rules:[{required:!0,message:\"结束时间不可为空\",trigger:\"change\"}]}},[a(\"el-date-picker\",{attrs:{readonly:\"readonly\"===e.readStatus,type:\"datetime\",placeholder:\"选择结束时间\",\"value-format\":\"yyyy-MM-dd HH:mm:ss\"},model:{value:t.row.endTime,callback:function(a){e.$set(t.row,\"endTime\",a)},expression:\"scope.row.endTime\"}})],1)]}}])}),a(\"el-table-column\",{attrs:{prop:\"filePath\",label:\"招标文件\",width:\"200\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-form-item\",{attrs:{label:\"\",prop:\"form.tableData.\"+t.$index+\".fileList\",rules:[{required:!0,message:\"招标文件不可为空\",trigger:\"change\"}]}},[\"\"===e.readStatus?a(\"el-upload\",{ref:\"upload\",staticClass:\"upload-demo\",attrs:{action:\"http://localhost:8089\",\"on-change\":function(a,r){e.handleChange(a,r,t.$index)},\"on-preview\":e.handlePreview,\"on-remove\":function(a,r){e.handleRemove(a,r,t.$index)},limit:2,\"auto-upload\":!1}},[e._v(\" 选取文件 \")]):e._e(),\"readonly\"===e.readStatus?a(\"p\",[e._v(e._s(t.row.fileName))]):e._e()],1)]}}])}),\"\"===e.readStatus?a(\"el-table-column\",{attrs:{label:\"操作\",width:\"50\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{attrs:{type:\"text\",size:\"small\"},nativeOn:{click:function(a){return a.preventDefault(),e.deleteRow(t.$index)}}},[e._v(\"删除\")])]}}],null,!1,3395820834)}):e._e()],1)],1),a(\"el-form-item\",[a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.downloadOrderExcel}},[e._v(\"投标信息下载\")])],1),a(\"el-form-item\",{attrs:{label:\"投标信息\"}},[a(\"el-table\",{staticStyle:{width:\"100%\"},attrs:{data:e.orderList,\"row-class-name\":e.tableRowClassName}},[a(\"el-table-column\",{attrs:{prop:\"index\",label:\"序号\",width:\"80\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[e._v(\" \"+e._s(t.$index+1)+\" \")]}}])}),a(\"el-table-column\",{attrs:{prop:\"orderPeopleName\",label:\"投标联系人姓名\",width:\"130\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[e._v(\" \"+e._s(t.row.name)+\" \")]}}])}),a(\"el-table-column\",{attrs:{prop:\"orderPeoplePhone\",label:\"投标联系人电话\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[e._v(\" \"+e._s(t.row.phoneNum)+\" \")]}}])}),a(\"el-table-column\",{attrs:{prop:\"unitName\",label:\"投标单位\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[e._v(\" \"+e._s(t.row.unitName)+\" \")]}}])}),a(\"el-table-column\",{attrs:{prop:\"total\",label:\"总金额（元）\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[e._v(\" \"+e._s(t.row.total)+\" \")]}}])}),a(\"el-table-column\",{attrs:{prop:\"downloadStatus\",label:\"已下载包件\",filters:[{text:\"否\",value:0},{text:\"是\",value:1}],\"filter-method\":e.filterDownload},scopedSlots:e._u([{key:\"default\",fn:function(t){return[0===t.row.downloadStatus?a(\"el-tag\",{key:\"否\",attrs:{type:\"danger\",effect:\"dark\"}},[e._v(\" 否 \")]):e._e(),1===t.row.downloadStatus?a(\"el-tag\",{key:\"是\",attrs:{type:\"success\",effect:\"dark\"}},[e._v(\" 是 \")]):e._e()]}}])}),a(\"el-table-column\",{attrs:{prop:\"status\",label:\"订单状态\",width:\"150\",filters:[{text:\"待付款\",value:0},{text:\"已付款\",value:1},{text:\"已完成\",value:2},{text:\"已失效\",value:3},{text:\"未通过\",value:4}],\"filter-method\":e.filterStatus},scopedSlots:e._u([{key:\"default\",fn:function(t){return[0===t.row.status?a(\"el-tag\",{key:\"待付款\",attrs:{type:\"warning\",effect:\"dark\"}},[e._v(\" 待付款 \")]):e._e(),1===t.row.status?a(\"el-tag\",{key:\"已付款\",attrs:{type:\"primary\",effect:\"dark\"}},[e._v(\" 已付款 \")]):e._e(),2===t.row.status?a(\"el-tag\",{key:\"已完成\",attrs:{type:\"success\",effect:\"dark\"}},[e._v(\" 已完成 \")]):e._e(),3===t.row.status?a(\"el-tag\",{key:\"已失效\",attrs:{type:\"info\",effect:\"dark\"}},[e._v(\" 已失效 \")]):e._e(),4===t.row.status?a(\"el-tag\",{key:\"未通过\",attrs:{type:\"danger\",effect:\"dark\"}},[e._v(\" 未通过 \")]):e._e()]}}])}),a(\"el-table-column\",{attrs:{label:\"操作\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[a(\"el-button\",{attrs:{type:\"text\",size:\"small\"},on:{click:function(a){return e.onclickOrderDetails(t.row)}}},[e._v(\"查看详情\")])]}}])})],1),a(\"div\",{staticClass:\"block\"},[a(\"el-pagination\",{staticStyle:{padding:\"30px 0\",\"text-align\":\"center\"},attrs:{\"current-page\":e.page,\"page-sizes\":[5,10,20,50],\"page-size\":e.limit,layout:\"total, sizes, prev, pager, next, jumper\",total:e.total},on:{\"size-change\":e.handleSizeChange,\"current-change\":e.handleCurrentChange}})],1)],1)],1)],1)},o=[],n=a(\"c7eb\"),l=a(\"1da1\"),i=(a(\"a434\"),a(\"a9e3\"),a(\"b775\"));function s(e){return Object(i[\"a\"])({url:\"/api/project/getProjectById\",method:\"post\",data:e})}function c(e,t,a){return Object(i[\"a\"])({url:\"/api/order/getOrderList/\"+e+\"/\"+t,method:\"post\",data:a})}function d(e){return Object(i[\"a\"])({url:\"/api/project/stopProject/\"+e,method:\"post\"})}function u(e){return Object(i[\"a\"])({url:\"/api/project/deleteProject/\"+e,method:\"post\"})}var p=a(\"ad8f\"),f=a(\"c1df\"),m=a.n(f),h={data:function(){return{queryData:{id:0},projectInfo:null,orderQueryData:{username:\"\",id:0},orderList:null,page:1,limit:5,total:0,readStatus:\"readonly\",fileList:[],updateData:{projectName:\"\",addition:\"\",packageList:[],status:[],projectId:\"\"}}},created:function(){this.queryData.id=this.$route.params.id,this.orderQueryData.id=this.$route.params.id,this.getProjectDetails(),this.getOrderListPage()},methods:{getProjectDetails:function(){var e=this;return Object(l[\"a\"])(Object(n[\"a\"])().mark((function t(){return Object(n[\"a\"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.next=3,s(e.queryData).then((function(t){e.projectInfo=t.data,e.updateData.packageList=t.data.packageList;for(var a=e.updateData.packageList.length,r=0;r<a;r++)e.$set(e.updateData.packageList[r],\"startTime\",new Date(e.updateData.packageList[r].startTime)),e.$set(e.updateData.packageList[r],\"endTime\",new Date(e.updateData.packageList[r].endTime)),e.updateData.status.push(2),e.fileList.push({});e.listLoading=!1}));case 3:case\"end\":return t.stop()}}),t)})))()},getOrderListPage:function(){var e=this;c(this.page,this.limit,this.orderQueryData).then((function(t){e.orderList=t.data.records,e.total=t.data.total}))},handleSizeChange:function(e){this.limit=e,this.getOrderListPage(),console.log(\"每页 \".concat(e,\" 条\"))},handleCurrentChange:function(e){this.page=e,this.getOrderListPage(),console.log(\"当前页: \".concat(e))},handleUpdataForm:function(){this.readStatus=\"\"},handleSubmitUpdata:function(){var e=this;return Object(l[\"a\"])(Object(n[\"a\"])().mark((function t(){var a,r;return Object(n[\"a\"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.readStatus=\"readonly\",e.updateData.projectId=e.projectInfo.id,e.updateData.projectName=e.projectInfo.projectName,e.updateData.addition=e.projectInfo.addition,e.updateData.id=e.projectInfo.projectId,a=0;case 6:if(!(a<e.fileList.length)){t.next=18;break}if(e.updateData.packageList[a].startTime=m()(new Date(e.updateData.packageList[a].startTime)).format(\"YYYY-MM-DD HH:mm:ss\"),e.updateData.packageList[a].endTime=m()(new Date(e.updateData.packageList[a].endTime)).format(\"YYYY-MM-DD HH:mm:ss\"),2!==e.updateData.status[a]){t.next=11;break}return t.abrupt(\"continue\",15);case 11:return r=new FormData,r.append(\"file\",e.fileList[a].raw),t.next=15,Object(p[\"b\"])(r).then((function(t){\"success\"===t.message?(e.updateData.packageList[a].filePath=t.data.filePath,e.updateData.packageList[a].fileName=t.data.fileName):a-=1}));case 15:a++,t.next=6;break;case 18:Object(p[\"d\"])(e.updateData).then((function(t){e.$message.success(\"更新成功！\"),e.$router.push({name:\"project_details\",params:{id:e.projectInfo.id}})}));case 19:case\"end\":return t.stop()}}),t)})))()},cancelModification:function(){this.$router.go(0)},onclickStopProject:function(){d(this.projectInfo.id).then((function(e){console.log(e)}))},onclickDeleteProject:function(){var e=this;u(this.projectInfo.id).then((function(t){e.$router.push(\"/table\"),console.log(t)}))},onclickOrderDetails:function(e){this.$router.push({name:\"order_details\",params:{id:e.id}})},addList:function(){this.updateData.packageList.push({id:\"\",fileName:\"\",filePath:\"\",packageName:\"\",price:\"\",projectId:this.projectInfo.id,startTime:\"\",endTime:\"\"}),this.updateData.status.push(2),this.fileList.push({})},addParamsSetting:function(){this.addList()},deleteRow:function(e){this.updateData.packageList.splice(e,1),this.updateData.status.splice(e,1),this.fileList.splice(e,1)},handleChange:function(e,t,a){var r=Number(e.size/1024/1024);if(r>2048)return this.$message.warning(\"文件大小不能超过2GB，请重新上传。\"),void t.splice(t.length-1,1);while(t.length>1)t.splice(0,1);e&&(this.fileList[a]=t[t.length-1],\"\"===this.updateData.packageList[a].filePath?this.updateData.status[a]=0:this.updateData.status[a]=1)},handleRemove:function(e,t,a){this.fileList[a]={}},handlePreview:function(e){console.log(e)},downloadOrderExcel:function(){var e=\"https://www.huaskj.com/bidding-be-api//api/order/downloadOrderList/\"+this.projectInfo.id,t=document.createElement(\"a\");t.href=e,t.click()},filterDownload:function(e,t){return t.downloadStatus===e},filterStatus:function(e,t){return t.status===e}}},g=h,b=a(\"2877\"),k=Object(b[\"a\"])(g,r,o,!1,null,\"064c4ae0\",null);t[\"default\"]=k.exports},a434:function(e,t,a){\"use strict\";var r=a(\"23e7\"),o=a(\"23cb\"),n=a(\"a691\"),l=a(\"50c4\"),i=a(\"7b0b\"),s=a(\"65f0\"),c=a(\"8418\"),d=a(\"1dde\"),u=a(\"ae40\"),p=d(\"splice\"),f=u(\"splice\",{ACCESSORS:!0,0:0,1:2}),m=Math.max,h=Math.min,g=9007199254740991,b=\"Maximum allowed length exceeded\";r({target:\"Array\",proto:!0,forced:!p||!f},{splice:function(e,t){var a,r,d,u,p,f,k=i(this),y=l(k.length),w=o(e,y),v=arguments.length;if(0===v?a=r=0:1===v?(a=0,r=y-w):(a=v-2,r=h(m(n(t),0),y-w)),y+a-r>g)throw TypeError(b);for(d=s(k,r),u=0;u<r;u++)p=w+u,p in k&&c(d,u,k[p]);if(d.length=r,a<r){for(u=w;u<y-r;u++)p=u+r,f=u+a,p in k?k[f]=k[p]:delete k[f];for(u=y;u>y-r+a;u--)delete k[u-1]}else if(a>r)for(u=y-r;u>w;u--)p=u+r-1,f=u+a-1,p in k?k[f]=k[p]:delete k[f];for(u=0;u<a;u++)k[u+w]=arguments[u+2];return k.length=y-r+a,d}})},ad8f:function(e,t,a){\"use strict\";a.d(t,\"c\",(function(){return n})),a.d(t,\"a\",(function(){return l})),a.d(t,\"d\",(function(){return i})),a.d(t,\"b\",(function(){return s}));var r=a(\"b775\"),o=\"/api/project\";function n(e,t,a){return Object(r[\"a\"])({url:o+\"/projectListByLimit/\"+e+\"/\"+t,method:\"post\",data:a})}function l(e){return Object(r[\"a\"])({url:o+\"/addProject\",method:\"post\",data:e})}function i(e){return Object(r[\"a\"])({url:o+\"/updateProject\",method:\"post\",data:e})}function s(e){return Object(r[\"a\"])({url:o+\"/addProjectFile\",method:\"post\",headers:{\"Content-Type\":\"multipart/form-data;charset=utf-8\"},data:e})}}}]);","extractedComments":[]}